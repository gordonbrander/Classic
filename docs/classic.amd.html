<!DOCTYPE html>  <html> <head>   <title>classic.amd.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               classic.amd.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="nx">define</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Fast slice lookup.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">slice</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">;</span>
  </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Merge any number of objects together, using shallow copy for efficiency.
The first object is modified in place (doesn't return a new object).
The last mentioned object property wins.</p>

<p>Serves the same purpose as jQuery.extend or _.extend.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">merge</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">objects</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="nx">key</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">objN</span><span class="p">,</span> <span class="nx">val</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">objects</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">objN</span> <span class="o">=</span> <span class="nx">objects</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">objN</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">objN</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Create a new object, using the provided object as its prototype
(prototypal inheritance). Delegates to native Object.create,
if supported.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">create</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">nativeCreate</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">nativeCreate</span><span class="p">)</span> <span class="k">return</span> <span class="nx">nativeCreate</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="kd">function</span> <span class="nx">Ctor</span><span class="p">()</span> <span class="p">{}</span>
    <span class="nx">Ctor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Ctor</span><span class="p">();</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Minimal classical inheritance from object literals. <br />
Inspired by jashkenas' Proposal: <a href="https://gist.github.com/1329619">https://gist.github.com/1329619</a>.</p>

<p>Properties of passed objects will be attached to the prototype of your
new function.</p>

<p><strong>Classical inheritance</strong>: if the first argument is another constructor 
function, a prototype chain will be created between it and the resulting
child function. This gives you classical inheritance via efficient 
prototype chaining, without emulating <code>super</code> or <code>static</code>.</p>

<p>Check it out -- define a base class:</p>

<pre><code>var Bunny = classic({
  hop: function (length) { ... }
});
</code></pre>

<p>...and inherit from it:</p>

<pre><code>var JackRabbit = classic(Bunny, {
  constructor: function (type) {
    this.type = type;
  },
  skip: function (length) { ... }
});
</code></pre>

<p>All prototype properties of Bunny are available to JackRabbit:</p>

<pre><code>var myJackRabbit = new Jackrabbit('grey');
myJackRabbit.hop();
myJackRabbit.skip();
</code></pre>

<p>Multiple inheritance is also supported. Pass in any number of
objects to be mixed in with the prototype:</p>

<pre><code>var artist = { ... };
var musician = { ... };
var writer = { ... };
var Composer = classic(artist, musician, writer);

var myComposer = new Composer();
</code></pre>

<p>Mix in objects are merged. and the last mentioned property wins,
as you might expect.</p>

<p>Want to do both? Go for it. The first property may optionally be a
function, followed by any number of objects.</p>

<pre><code>var BrownBear = classic(Animal, bear, best);
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">classic</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Parent</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="c1">// If the first param is a function, consider it the parent function.</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Cache this test, since we use it more than once.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">hasParent</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;function&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">Parent</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Get the "rest" of the arguments as an array of objects.
If the first parameter is a parent function, exclude it from
the array -- we treat parent funcs differently.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">rest</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="p">(</span><span class="nx">hasParent</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)),</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Create a new object for our prototype.
If a parent function has been provided, construct an object
using it's prototype as the proototype for our new object.
Otherwise, use an ordinary object.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">proto</span> <span class="o">=</span> <span class="nx">hasParent</span> <span class="o">?</span> <span class="nx">create</span><span class="p">(</span><span class="nx">Parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)</span> <span class="o">:</span> <span class="p">{},</span>
        <span class="nx">Child</span><span class="p">;</span>
    </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Merge all "rest" objects into our newly created object.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">merge</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">[</span><span class="nx">proto</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">rest</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Get constructor function from:</p>

<ul>
<li><code>constructor</code> property of merged proto object, if present.
(Limitation: must be an "own" property, since all objects
have "Object" as a constructor property on their prototype).</li>
<li>OR patch in the parent constructor if a parent has been provided</li>
<li>OR use an empty function if no parent is assigned.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">Child</span> <span class="o">=</span> <span class="p">(</span>
      <span class="nx">proto</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;constructor&#39;</span><span class="p">)</span> <span class="o">?</span>
        <span class="nx">proto</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">:</span>
        <span class="p">(</span>
          <span class="nx">hasParent</span> <span class="o">?</span>
            <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
              <span class="k">return</span> <span class="nx">Parent</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
            <span class="p">}</span> <span class="o">:</span>
            <span class="kd">function</span> <span class="p">()</span> <span class="p">{}</span>
        <span class="p">)</span>
    <span class="p">);</span>
    </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Now that we have a constructor function, assign our prototype object
to it.</p>

<p>After assignment, set the fully finished constructor function (with
prototype) as the constructor property of the prototype.
Putting a constructor property on the prototype will
guaranteed you have one, even if the browser does not set it during
construction (<strong>cough, IE, cough</strong>).</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="p">(</span><span class="nx">Child</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">proto</span><span class="p">).</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Child</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">Child</span><span class="p">;</span>
  <span class="p">};</span>
  </pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Expose these handy helper methods.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">classic</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="nx">create</span><span class="p">;</span>
  <span class="nx">classic</span><span class="p">.</span><span class="nx">merge</span> <span class="o">=</span> <span class="nx">merge</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="nx">classic</span><span class="p">;</span>
<span class="p">});</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 